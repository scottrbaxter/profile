set nocompatible              " be iMproved, required
filetype off                  " required

" set the runtime path to include Vundle and initialize
set rtp+=~/.vim/bundle/Vundle.vim
call vundle#begin()
" alternatively, pass a path where Vundle should install plugins
"call vundle#begin('~/some/path/here')

" let Vundle manage Vundle, required
Plugin 'VundleVim/Vundle.vim'

" The following are examples of different formats supported.
" Keep Plugin commands between vundle#begin/end.
" plugin on GitHub repo
" Plugin 'tpope/vim-fugitive'
" plugin from http://vim-scripts.org/vim/scripts.html
" Plugin 'L9'
" Git plugin not hosted on GitHub
" Plugin 'git://git.wincent.com/command-t.git'
" git repos on your local machine (i.e. when working on your own plugin)
" Plugin 'file:///home/gmarik/path/to/plugin'
" The sparkup vim script is in a subdirectory of this repo called vim.
" Pass the path to set the runtimepath properly.
" Plugin 'rstacruz/sparkup', {'rtp': 'vim/'}
" Install L9 and avoid a Naming conflict if you've already installed a
" different version somewhere else.
" Plugin 'ascenator/L9', {'name': 'newL9'}

""" Vim Janus loaded plugins
Plugin 'Lokaltog/vim-easymotion'
" Plugin 'MarcWeber/vim-addon-mw-utils'
Plugin 'TechnoGate/janus-colors'
Plugin 'airblade/vim-gitgutter'
Plugin 'altercation/vim-colors-solarized'
Plugin 'ap/vim-css-color'
Plugin 'blueshirts/darcula'
Plugin 'bronson/vim-trailing-whitespace'
Plugin 'chrisbra/NrrwRgn'
Plugin 'chrisbra/csv.vim'
Plugin 'chriskempson/base16-vim'
Plugin 'chriskempson/vim-tomorrow-theme'
Plugin 'ctrlpvim/ctrlp.vim'
Plugin 'depuracao/vim-rdoc'
" Plugin 'ervandew/supertab'
" Plugin 'garbas/vim-snipmate'
" Plugin 'honza/vim-snippets'
Plugin 'jeetsukumaran/vim-buffergator'
Plugin 'larssmit/vim-getafe'
Plugin 'majutsushi/tagbar'
Plugin 'mattn/gist-vim'
Plugin 'mattn/webapi-vim'
Plugin 'michaeljsmith/vim-indent-object'
Plugin 'mileszs/ack.vim'
Plugin 'mmalecki/vim-node.js'
Plugin 'rgarver/Kwbd.vim'
Plugin 'scrooloose/nerdcommenter'
Plugin 'scrooloose/nerdtree'
Plugin 'sh-dude/ZoomWin'
Plugin 'sheerun/vim-polyglot'
Plugin 'sjl/gundo.vim'
Plugin 'skalnik/vim-vroom'
Plugin 'sunaku/vim-ruby-minitest'
Plugin 'telamon/vim-color-github'
Plugin 'terryma/vim-multiple-cursors'
Plugin 'thinca/vim-visualstar'
" Plugin 'tomtom/tlib_vim'
Plugin 'tpope/vim-dispatch'
Plugin 'tpope/vim-endwise'
Plugin 'tpope/vim-eunuch'
Plugin 'tpope/vim-fugitive'
" Plugin 'tpope/vim-pathogen'
Plugin 'tpope/vim-rails'
Plugin 'tpope/vim-repeat'
Plugin 'tpope/vim-surround'
Plugin 'tpope/vim-unimpaired'
Plugin 'tpope/vim-vividchalk'
Plugin 'twerth/ir_black'
Plugin 'vim-scripts/Colour-Sampler-Pack'
Plugin 'vim-scripts/molokai'
Plugin 'vim-scripts/pyte'
Plugin 'vim-scripts/vimwiki'
" Plugin 'vim-syntastic/syntastic'

""" Custom plugins from ~/.janus
Plugin 'bronson/vim-crosshairs'
Plugin 'dense-analysis/ale'
Plugin 'godlygeek/tabular'
" Plugin 'hashivim/vim-terraform'
Plugin 'ivanov/vim-ipython'
Plugin 'jeetsukumaran/vim-indentwise'
" Plugin 'juliosueiras/terraform-lsp'
" Plugin 'keith/swift'
Plugin 'liuchengxu/space-vim-dark'
Plugin 'ntpeters/vim-better-whitespace'
Plugin 'nvie/vim-flake8'
Plugin 'pearofducks/ansible-vim'
Plugin 'rstacruz/vim-closer'
Plugin 'vim-airline/vim-airline'
Plugin 'vim-airline/vim-airline-themes'
Plugin 'willthames/ansible-lint'
Plugin 'Yggdroot/indentLine'
Plugin 'ycm-core/YouCompleteMe'

" All of your Plugins must be added before the following line
call vundle#end()            " required
filetype plugin indent on    " required
" To ignore plugin indent changes, instead use:
"filetype plugin on
"
" Brief help
" :PluginList       - lists configured plugins
" :PluginInstall    - installs plugins; append `!` to update or just :PluginUpdate
" :PluginSearch foo - searches for foo; append `!` to refresh local cache
" :PluginClean      - confirms removal of unused plugins; append `!` to auto-approve removal
"
" see :h vundle for more details or wiki for FAQ
" Put your non-Plugin stuff after this line


""" from ~/.vim/janus/vim/core/before/plugin/settings.vim
""
"" Basic Setup
""

if has('vim_starting') && !has('nvim') && &compatible
  set nocompatible               " Be iMproved
endif
set number            " Show line numbers
set ruler             " Show line and column number
syntax enable         " Turn on syntax highlighting allowing local overrides
" Neovim disallow changing 'enconding' option after initialization
" see https://github.com/neovim/neovim/pull/2929 for more details
if !has('nvim')
  set encoding=utf-8  " Set default encoding to UTF-8
endif

""
"" Whitespace
""

set nowrap                        " don't wrap lines
set tabstop=2                     " a tab is two spaces
set shiftwidth=2                  " an autoindent (with <<) is two spaces
set expandtab                     " use spaces, not tabs
set list                          " Show invisible characters
set backspace=indent,eol,start    " backspace through everything in insert mode

if exists("g:enable_mvim_shift_arrow")
  let macvim_hig_shift_movement = 1 " mvim shift-arrow-keys
endif

" List chars
set listchars=""                  " Reset the listchars
set listchars=tab:\ \             " a tab should display as "  ", trailing whitespace as "."
set listchars+=trail:.            " show trailing spaces as dots
set listchars+=extends:>          " The character to show in the last column when wrap is
                                  " off and the line continues beyond the right of the screen
set listchars+=precedes:<         " The character to show in the last column when wrap is
                                  " off and the line continues beyond the left of the screen

""
"" Searching
""

set hlsearch    " highlight matches
set incsearch   " incremental searching
set ignorecase  " searches are case insensitive...
set smartcase   " ... unless they contain at least one capital letter

""
"" Wild settings
""

" TODO: Investigate the precise meaning of these settings
" set wildmode=list:longest,list:full

" Disable output and VCS files
set wildignore+=*.o,*.out,*.obj,.git,*.rbc,*.rbo,*.class,.svn,*.gem

" Disable archive files
set wildignore+=*.zip,*.tar.gz,*.tar.bz2,*.rar,*.tar.xz

" Ignore bundler and sass cache
set wildignore+=*/vendor/gems/*,*/vendor/cache/*,*/.bundle/*,*/.sass-cache/*

" Ignore librarian-chef, vagrant, test-kitchen and Berkshelf cache
set wildignore+=*/tmp/librarian/*,*/.vagrant/*,*/.kitchen/*,*/vendor/cookbooks/*

" Ignore rails temporary asset caches
set wildignore+=*/tmp/cache/assets/*/sprockets/*,*/tmp/cache/assets/*/sass/*

" Disable temp and backup files
set wildignore+=*.swp,*~,._*

""
"" Backup and swap files
""

set backupdir^=~/.vim/_backup//    " where to put backup files.
set directory^=~/.vim/_temp//      " where to put swap files.

""" Necessary new stuff
" let g:snipMate = {'snippet_version': 1}

""" From vim-janus ~/.vimrc.before
" NERDCommenter stuff
let g:NERDSpaceDelims = 1 " adds # of spaces default for all filetypes
let g:NERDDefaultAlign = 'left' " always to far left
let g:NERDAltDelims_python = 1 " without this python double spaces
let g:NERDCustomDelimiters = { 'arduino': { 'left': '//','right': '' } } " required for proper .ino file comments
let g:NERDCustomDelimiters = { 'ansible_template': { 'left': '#','right': '' } } " required for proper ansible file comments
let g:NERDCustomDelimiters = { 'text': { 'left': '#','right': '' } } " use # for unspecified file comments
let g:NERDTrimTrailingWhitespace = 1 " Enable trimming of trailing whitespace when uncommenting
" let g:NERDCommentEmptyLines = 1 " Allow commenting and inverting empty lines

" powerline fancy stuff
" let g:Powerline_symbols = 'fancy'

" airline theme set here
let g:airline_theme='distinguished'
" let g:airline_powerline_fonts = 1
" let g:Powerline_symbols = 'unicode'
if !exists('g:airline_symbols')
  let g:airline_symbols = {}
endif
let g:airline_symbols.space = "\ua0"
set encoding=utf-8

" This setting must be set before ALE is loaded.
let g:ale_completion_enabled = 1

let g:airline#extensions#ale#enabled = 1

""" From vim-janus ~/.vimrc.after

" personal custom shortcuts
nmap <silent> <space>j <Plug>(ale_next_wrap)
nmap <silent> <space>J <Plug>(ale_previous_wrap)
nmap <silent> <space><up> [c " GitGutterPrevHunk
nmap <silent> <space><down> ]c " GitGutterNextHunk
nmap <silent> <space><right> <leader>hp:wincmd P<CR>gg " GitGutterPreviewHunk
nmap <space> \
nmap <space>a \cA
nmap <space>d :Gdiff<CR>
nmap <space>f :FixWhitespace<CR>
nmap <space>r \c<space>
nmap <space>b :Gblame<CR>
nmap <space>d :Gdiff<CR>
nmap <space>q :q<CR>
nmap <space>Q :q!<CR>
nmap <space>w :w<CR>
nmap <space><tab> :%s/\t/    /g<CR>
nmap <space>' cs"'
nmap <space>" cs'"
nmap ' ysiw'
nmap " ysiw"
nmap <space>[ ysiw]
nmap <space>] ysiw}i$<Esc>
nmap <space>} ysiw{
nmap <space>{ ysiw[
nmap <space>- :s/-/_/<CR>
vmap <space>- :s/\%V-/_/<CR>
nmap <space>_ :s/_/-/<CR>
vmap <space>_ :s/\%V_/-/<CR>
nmap ` v~
nmap t :TagbarOpenAutoClose<CR>
nnoremap q :q<CR>
vmap <space>r \c<space>
vmap <space>= :s/[ ]\{2,}=/ =/g<CR><C-O>
nmap <space>= :%s/[ ]\{2,}=/ =/g<CR><C-O>
vmap <space>t :Tabularize /=<CR>
vmap <space>T :Tabularize<CR>
vmap <space># :Tabularize /#<CR>
vmap <space>" :Tabularize /"<CR>
vnoremap A <C-v>$A
vnoremap I <C-v>$I
" nmap v<down> vi}
nmap <silent> <space>c :call MessageToClipboard()<CR>
nmap f zA| " toggle open/close folding
nmap F :call FoldAllToggle()<cr>| " equiv to toggle for zM/zR

" set nonumber
" set nolist " list disables linebreak
" set lbr " without lbr the line can be split on a word
set nocompatible
" end of line has $, tab has ▸
set list lcs=eol:¬,tab:▸\-
" set list lcs=tab:\▸\
set wrap

" au == autocmd
" autocmd VimEnter *.py nested :TagbarOpen
" autocmd VimEnter *.sh nested :TagbarOpen
" autocmd VimEnter * if &ft!='ansible.yaml' | nested :TagbarOpen | endif

" quit help with 'q'
au FileType help noremap <buffer> q :q<cr>

" disable 'recording @p'
" map q <Nop>
" disable 'Entering Ex mode'
map Q <Nop>

" search down into subfolders
" provides tab-completion for all file-related tasks
set path+=** " '**' recursively searches through subdirectories
set wildmenu " Display all matching files when we tab-complete

" se mouse=c "
" se mouse=a " mouse copy turns into visual mode and provides smooth scroll all nice like, i prefer this one
se mouse+=a " mouse copy turns into visual mode
" se mouse=nicr " mouse scroll is nicer, and click puts you where the mouse is, but click select doesn't enable visual mode
" let g:wheel#scroll_on_wrap = 1      " 0=disable, 1=enable (default)

" set ttymouse=sgr
" set balloondelay=250
" set ballooneval
" set balloonevalterm
let g:ale_set_balloons = 1

if !has('nvim')
  set clipboard=autoselect " yank to osx clipboard, but doesn't put vim's change/delete stuff in clipboard
" set clipboard=unnamedplus,unnamed,autoselect " yank to osx clipboard
"set clipboard=unnamed,autoselect " yank to osx clipboard including change/delete in vim
endif

" move to 1st character on line when changing lines
nmap <Up> <Up>^
nmap <Down> <Down>^
" vimdiff vertical split switching
nmap <S-C-Left> <C-W>h
nmap <S-C-Right> <C-W>l
" hold shift to highlight text in visual mode.
nmap <S-Up> V<Up>^
nmap <S-Down> V<Down>^
vmap <S-Up> <Up>
vmap <S-Down> <Down>
vmap <S-Left> <
vmap <S-Right> >
" vmap <S-Left> <Left>
" vmap <S-Right> <Right>
" change indent while in normal mode
nmap <S-Left> <<
nmap <S-Right> >>

" leaves cursor after end of yank while in visual mode, not needed with 'se mouse+=a'
" vmap y y`]

" NerdTree on vim start
" au StdinReadPre * let s:std_in=1
" au VimEnter * if argc() == 0 && !exists("s:std_in") | NERDTree | endif

" powerline fancy stuff
let g:Powerline_symbols = 'fancy'

" Make vim searches case insensitive
" set ignorecase " won't find insensitive searches if using capital letter in search
set smartcase " will change to case sensitive if typing capital letters

" vim-indentwise remappings
map <S-C-Up> <Plug>(IndentWisePreviousEqualIndent)
map <S-C-Down> <Plug>(IndentWiseNextEqualIndent)

"map [- <Plug>(IndentWisePreviousLesserIndent)
"map [= <Plug>(IndentWisePreviousEqualIndent)
"map [+ <Plug>(IndentWisePreviousGreaterIndent)
"map ]- <Plug>(IndentWiseNextLesserIndent)
"map ]= <Plug>(IndentWiseNextEqualIndent)
"map ]+ <Plug>(IndentWiseNextGreaterIndent)
"map [_ <Plug>(IndentWisePreviousAbsoluteIndent)
"map ]_ <Plug>(IndentWiseNextAbsoluteIndent)
"map [% <Plug>(IndentWiseBlockScopeBoundaryBegin)
"map ]% <Plug>(IndentWiseBlockScopeBoundaryEnd)

" http://vimdoc.sourceforge.net/htmldoc/filetype.html
" needed both of these for nerdcommenter to play nice
filetype plugin on " detect: on, plugin: on, indent: unchanged
" filetype indent off " detect: unchanged, plugin: unchanged, indent: off

" insert new line in normal mode by pressing enter without using insert mode
" leaves cursor on initial line
nmap <CR> o<Esc>

" change U to redo
" http://vim.wikia.com/wiki/Undo_and_Redo
map <S-u> <C-r>


" toggle highlight
nnoremap <silent> <F2> :set hlsearch!<CR>

" highlight whole word on click-drag
" nmap <S-LeftMouse> viw
" nmap <S-LeftDrag> viw
" nmap <S-LeftRelease> w

" add single quote around text until next white space
" nnoremap " lBcE""<Esc>Pw
" nnoremap ' lBcE''<Esc>Pw
" nnoremap [ lBcE[]<Esc>Pw
" nnoremap { lBcE"{{  }}"<Esc>3hPw
" add single quote around word
" nnoremap " ciw""<Esc>P
" nnoremap ' ciw''<Esc>P
" nnoremap [ ciw[]<Esc>Pw
" nnoremap { ciw{}<Esc>Pw

" nmap <Leader>' ds'
" nmap <Leader>" ds"
" nmap <Leader>[ ds[
" nmap <Leader>{ ds{ds{ds"
" nmap <Leader>( ds(

" stay in visual mode when changing indent level with < or >
vmap < <gv
vmap > >gv

" shortcuts in normal mode
nmap ge G$
nmap ; :
nmap ;q :q<CR>
nmap ;Q :q!<CR>
nmap v ve
nnoremap <bs> i<bs><esc>w
nnoremap <tab> >>
nnoremap <S-tab> <<

" don't add newline character if the file didn't already have one
set nofixeol

" colorscheme default " reverts colorscheme
let g:space_vim_dark_background = 234 " (233 = darkest, 235 = default, 238 = lightest)
" set termguicolors " sets term to use gui colors
colorscheme space-vim-dark " submodule in profile repo
" autocmd FileType yaml colorscheme material-monokai " makes vim colors (expecially highlight) tolerant
" autocmd FileType yaml colorscheme asu1dark " makes vim colors (expecially highlight) tolerant
" autocmd FileType yaml colorscheme getafe " makes vim colors (expecially highlight) tolerant
" colorscheme getafe " makes vim colors (expecially highlight) tolerant

" highlighting (colors)
" You can see all the groups currently active with this command: >
    " :so $VIMRUNTIME/syntax/hitest.vim
highlight LineNr ctermfg=grey ctermbg=235
highlight Comment ctermfg=Grey
highlight Normal ctermfg=White
highlight Visual cterm=NONE ctermbg=052
highlight IncSearch cterm=NONE ctermbg=20 ctermfg=250
highlight Search cterm=NONE ctermbg=20 ctermfg=250
highlight SpellBad ctermbg=235
highlight SpellCap ctermbg=DarkRed
" highlight Search cterm=NONE ctermbg=237
" highlight Search cterm=NONE ctermfg=white ctermbg=blue
" highlight Search cterm=NONE ctermbg=103
" set colorcolumn=80 " vertical line at 80 characters


" let g:indentLine_setColors = 0 " highlight conceal color with your colorscheme
let g:indentLine_color_term = 239 " indent marker color
let g:indentLine_char = '|' " indent marker character (options: ¦┆│⎸▏)
let g:indentLine_concealcursor = 'inc'
let g:indentLine_conceallevel = 0 " default "2" hides markdown(.md) hyperlinks

" fix tab for proper indenting, except for ft-plugin file types that have this set elsewhere
" tabstop is the number of spaces pressing tab enters, softtapstop is the number of spaces deleted with the delete key
" expandtab changes tabs to spaces set tabstop=2 softtabstop=2 expandtab " global

" only needed if global tabstop is defined differently above
au FileType dockerfile setlocal tabstop=2 shiftwidth=2 softtabstop=2
au FileType gitconfig setlocal tabstop=4 shiftwidth=4 softtabstop=4 expandtab " conform to bashate (pep8) standards
au FileType python setlocal tabstop=4 shiftwidth=4 foldmethod=indent foldnestmax=10 foldlevel=2
au FileType ruby setlocal tabstop=2 shiftwidth=2 expandtab
au FileType sh setlocal tabstop=4 shiftwidth=4 softtabstop=4 expandtab " conform to bashate (pep8) standards
au FileType yaml setlocal tabstop=2 shiftwidth=2 softtabstop=2
au FileType yaml.ansible setlocal tabstop=2 shiftwidth=2 softtabstop=2
au FileType zsh setlocal tabstop=4 shiftwidth=4 softtabstop=4 expandtab " conform to bashate (pep8) standards

" ansible formatting for yaml files
" au BufNewFile,BufRead *.ini set filetype=ansible_hosts
" au BufEnter * if &filetype == "" | setlocal ft=sh | endif
" au BufNewFile,BufRead *.yaml set filetype=ansible.yaml
" au BufNewFile,BufRead *.yml set filetype=ansible.yaml
au BufRead,BufNewFile */playbooks/*.y*ml set filetype=ansible.yaml
au BufRead,BufNewFile *.hcl set filetype=terraform
au BufNewFile,BufRead *.yaml setlocal indentkeys=0{,0},:,0#,!^F,o,0,e
au BufEnter * if &filetype == "" | setlocal ft=text | endif " any unknown filetype will be known as 'text'
let g:ansible_unindent_after_newline = 1
let g:ansible_extra_syntaxes = "sh.vim ruby.vim"
let g:ansible_attribute_highlight = "a"

" FKey Reference
" F1 help
" F3 set/unset line wrap (janus shortcut = \tw)
" F4 nopaste/paste
" F5 open Gundo
" F6 pretty print json (.json files only)
" F7 toggle line break
" F8 set autoindent
" F9 flake8 linter (python files only), toggle conceal level (json files only)
" F10 vim display highlight group
" F11 toggle vertical line at 80 characters

" :set inv{thing} sets the inverted, and :set {thing}? shows what the value is set to
" set paste " handles pasting with additional comment or tabs, indentation is a pita here
" set autoindent " newline adds indents, toggle with F9
" au FileType python :set nopaste " keep jedi but also not new comment on new line after commented line
" nmap <silent> <F2> :set cursorline! cursorcolumn!<CR>

" From :help fo-table
" letter  meaning when present in 'formatoptions'
" t       Auto-wrap text using textwidth
" c       Auto-wrap comments using textwidth, inserting the current comment
"         leader automatically.
" r       Automatically insert the current comment leader after hitting
"         <Enter> in Insert mode.
" o       Automatically insert the current comment leader after hitting 'o' or
"         'O' in Normal mode.
" q       Allow formatting of comments with "gq".
"	        Note that formatting will not change blank lines or lines containing
"	        only the comment leader.  A new paragraph starts after such a line,
" l       Long lines are not broken in insert mode: When a line was longer than
"         'textwidth' when the insert command started, Vim does not
"         automatically format it.

function! ConcealLevelToggle()
    if &conceallevel
        setlocal conceallevel=0
    else
        setlocal conceallevel=2
    endif
endfunction

function! ColorColumnToggle()
    if &colorcolumn
        setlocal colorcolumn=0
    else
        setlocal colorcolumn=80
    endif
endfunction

function! MessageToClipboard()
  redir @+
  1message
  redir END
endfunction

au BufNewFile,BufRead * setlocal formatoptions-=cro " default: croql
nmap <silent> H :set cursorcolumn!<CR>
nmap <silent> <F3> :set invwrap<CR>:set wrap?<CR>
nmap <silent> <F7> :set invlbr<CR>:set lbr?<CR>
nmap <silent> <F8> :set invautoindent<CR>:set autoindent?<CR>
au FileType gitcommit set tw=99
au FileType json nnoremap <silent> <F6> :%!python -m json.tool<CR>
" au FileType json nnoremap <silent> <F9> :call ConcealLevelToggle()<CR>
" au FileType python map <buffer> <F9> :call Flake8()<CR>
au FileType json,yaml nnoremap <silent> <F9> :call ConvertJsonYaml()<CR>
au FileType markdown nnoremap <silent> <F9> :call ConcealLevelToggle()<CR>
au FileType markdown set tw=120
nmap <F10> :echo "hi<" . synIDattr(synID(line("."),col("."),1),"name") . '> trans<' . synIDattr(synID(line("."),col("."),0),"name") . "> lo<" . synIDattr(synIDtrans(synID(line("."),col("."),1)),"name") . ">"<CR>
nmap <silent> <F11> :call ColorColumnToggle()<CR>

" crosshair colors
hi CursorColumn cterm=NONE ctermbg=darkgrey ctermfg=grey guibg=darkred guifg=white

if has('persistent_undo')      "check if your vim version supports it
    set undofile                 "turn on the feature
    set undodir=$HOME/.vim/_temp  "directory where the undo files will be stored
endif

" signs to use for w0rp/ale linters
let g:ale_sign_error = '>>'
let g:ale_sign_warning = '--'
" how to use only specific linters
" let g:ale_linters = {
" \   'python': ['pylint', 'flake8'],
" \}
" vim-markdown-preview https://github.com/JamshedVesuna/vim-markdown-preview#mac-os-x
let vim_markdown_preview_github=1
let vim_markdown_preview_toggle=1
" let vim_markdown_preview_hotkey='<C-p>'
let vim_markdown_preview_browser='Google Chrome'

function! ConvertJsonYaml()
  if (&ft=='json')
    :%!json2yaml
    :set ft=yaml
  elseif (&ft=='yaml')
    :%!yaml2json
    :set ft=json
  endif
endfunction

" search hyphenated words
set iskeyword+=-

" vim folding
set nofoldenable

function! FoldAllToggle()
    if &foldlevel
        setlocal foldlevel=0
    else
        setlocal foldlevel=2
    endif
endfunction
